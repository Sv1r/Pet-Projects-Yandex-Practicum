# Определение стоимости автомобилей

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В вашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Вам нужно построить модель для определения стоимости. 

Заказчику важны:

- качество предсказания;
- скорость предсказания;
- время обучения.

## Вывод

Исходные данные содержали пропуски и дубликаты, которые были обработаны в рамках препоцессинга. Для пропусков в различных категориальных переменных был выбран индивидуальный подход заполнения на основе остальных признаков. От дубликатов же мы избавились, так как их общее количество было крайне мало.

Помимо прочего мы обработали данные с точки зрения наличия в них выбросов и аномальных значений. Так, например, в признаке ***Price*** при помощи построения гистограммы и ящика с усами обнаружились нулевые значения, которые в последствие могли бы помешать корректной работе алгоритма машинного обучения. Таким же образом мы избавились от нулевых значений в признаке ***Power*** - мощности представленного автомобиля и в переменной ***RegistrationMonth***, где были метки нулевого месяца регистрации.

В добавок, признак ***Power*** ввиду наличия выбросов было решено ограничить полуторным интерквартильным размахом. Аналогичный подход был реализован для переменной ***RegistrationYear***. По итогам реализации данного подхода распределение вышеназванных признаков приблизилось к нормальному.

Была произведена оценка взаимосвязи переменных. Удалось выяснить, что цена сильнее всего зависит от года регистрации автомобиля - **0.55** по *Пирсону* и **0.66** по *Спирмену* и от мощности двигателя - **0.49** по *Пирсону* и **0.51** по *Спирмену*.

Далее на основе корреляционного анализа мы ввели новые категориальные переменные на основе года регистрации - ***registration_type***, где все объектам исходного датафрейма были присвоены категории - **new**, **middle** или **old**, и на основе мощности автомобиля - ***power_type*** с категориями - **weak**, **regular** и **powerful**.

Также была произведена оценка факторов влияния цены. Автомобили с типом кузова **suv** обладают самой высокой средней ценой - **9177 евро**. Самые дороги авто обладают типом коробки передач **auto** - средняя цена на оные составляет **6597 евро**. Машины с типом топлива **hybrid** имею самую высотку среднею цену - **9460 евро**. Самым дорогим бредом автомобиля является **porsche** со средней ценой в **12048 евро**. Машины прошедшие ремонт предсказуемо продаются за меньшую цену. В зависимости от введенных нами категорий, возраста и мощности, мы выявили, что средняя цена гораздо выше у более новых и мощных автомобилей, чем у старых и маломощных.

Было обучено несколько моделей машинного обучения:

 * **LinearRegression**
 * **DecisionTreeRegressor**
 * **RandomForestRegressor**
 * **LGBMRegressor**

В качестве метрики оценки качества использовалась **RMSE**. Наилучший показатель оной был зафиксирован у алгоритма **LGBMRegressor** со значением метрики **1452** и временем обучения в **5 минут 24 секунд**.
