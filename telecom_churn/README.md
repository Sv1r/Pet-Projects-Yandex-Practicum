# Телеком - отток клиентов

Оператор связи **«Ниединогоразрыва.ком»** хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

## Описание услуг

Оператор предоставляет два основных типа услуг: 

1. Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
2. Интернет. Подключение может быть двух типов: через телефонную линию (DSL*,* от англ. *digital subscriber line*, «цифровая абонентская линия») или оптоволоконный кабель (*Fiber optic*).  

Также доступны такие услуги:

- Интернет-безопасность: антивирус (*DeviceProtection*) и блокировка небезопасных сайтов (*OnlineSecurity*);
- Выделенная линия технической поддержки (*TechSupport*);
- Облачное хранилище файлов для резервного копирования данных (*OnlineBackup*);
- Стриминговое телевидение (*StreamingTV*) и каталог фильмов (*StreamingMovies*).

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

## Описание данных

Данные состоят из файлов, полученных из разных источников:

- `contract.csv` — информация о договоре;
- `personal.csv` — персональные данные клиента;
- `internet.csv` — информация об интернет-услугах;
- `phone.csv` — информация об услугах телефонии.

Во всех файлах столбец `customerID` содержит код клиента.

Информация о договорах актуальна на 1 февраля 2020.

## Вывод

Итак, исходные данные, состоящие из четырех таблиц, были объединены в единый датасет. Появившиеся в следствие объединения пропуски были заполнены исходя из предположения, что, если какой-то пользователь не представлен в дополнительных таблицах, то он не использует соответствующие услуги.

Мы произвели оценку взаимосвязи переменных при помощи матриц коэффициентов корреляции *Пирсона* и *Спирмена*. Была выявлена положительная сильная взаимосвязь между временем жизни клиентов и общей выручкой.

Далее был произведен исследовательский анализ, который позволил выявить некоторые особенности клиентов, отказавшихся от услуг компании. Такие клиенты имеют склонность к отказу от дополнительных пакетов. Помимо это, средняя полная выручка с подобных клиентов в полтора раза меньше, чем у постоянных пользователей. В добавок, среднее время жизни у таких пользователей в два раза меньше. 

После данные были адаптированы под работу с алгоритмами машинного обучения. Были выдели тренировочная, валидационная и тестовые выборки в соотношение **3:1:1**. Категориальные признаки были предобработанны при помощи техники **прямого кодирования**. Далее мы отмасштабировали полученные признаки на основе тренировочного датасета. И, наконец, был устранен дисбаланс классов методом **upsampling**.

Затем мы обучили несколько моделей машинного обучения:

- **LogisticRegression**
- **RandomForestClassifier**
- **LGBMClassifier**
- **CatBoostClassifier**

Лучшего всего на валидационной выборке себя показал алгоритм **LGBMClassifier**, для которого значение **ROC-AUC** составило **0.918**. Самый низкий результат был у линейного алгоритма **RandomForestClassifier**, равный **0.859**. На тестовых данных значение **ROC-AUC** у алгоритма **LGBMClassifier** составило **0.923**.
